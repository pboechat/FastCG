#include "ColorMatchingFunctions.h"
#include <Exception.h>

const float ColorMatchingFunctions::xBarFunction[] = { 0.00137f,
											0.00150f,
											0.00164f,
											0.00180f,
											0.00200f,
											0.00224f,
											0.00254f,
											0.00289f,
											0.00330f,
											0.00375f,
											0.00424f,
											0.00476f,
											0.00533f,
											0.00598f,
											0.00674f,
											0.00765f,
											0.00875f,
											0.01003f,
											0.01142f,
											0.01287f,
											0.01431f,
											0.01570f,
											0.01715f,
											0.01878f,
											0.02075f,
											0.02319f,
											0.02621f,
											0.02978f,
											0.03388f,
											0.03847f,
											0.04351f,
											0.04900f,
											0.05502f,
											0.06172f,
											0.06921f,
											0.07763f,
											0.08696f,
											0.09718f,
											0.10841f,
											0.12077f,
											0.13438f,
											0.14936f,
											0.16540f,
											0.18198f,
											0.19861f,
											0.21477f,
											0.23019f,
											0.24488f,
											0.25878f,
											0.27181f,
											0.28390f,
											0.29494f,
											0.30490f,
											0.31379f,
											0.32165f,
											0.32850f,
											0.33435f,
											0.33921f,
											0.34312f,
											0.34613f,
											0.34828f,
											0.34960f,
											0.35015f,
											0.35001f,
											0.34929f,
											0.34806f,
											0.34637f,
											0.34426f,
											0.34181f,
											0.33909f,
											0.33620f,
											0.33320f,
											0.33004f,
											0.32664f,
											0.32289f,
											0.31870f,
											0.31403f,
											0.30888f,
											0.30329f,
											0.29726f,
											0.29080f,
											0.28397f,
											0.27672f,
											0.26892f,
											0.26042f,
											0.25110f,
											0.24085f,
											0.22985f,
											0.21841f,
											0.20681f,
											0.19536f,
											0.18421f,
											0.17333f,
											0.16269f,
											0.15228f,
											0.14210f,
											0.13218f,
											0.12257f,
											0.11328f,
											0.10430f,
											0.09564f,
											0.08730f,
											0.07931f,
											0.07172f,
											0.06458f,
											0.05795f,
											0.05186f,
											0.04628f,
											0.04115f,
											0.03641f,
											0.03201f,
											0.02792f,
											0.02414f,
											0.02069f,
											0.01754f,
											0.01470f,
											0.01216f,
											0.00992f,
											0.00797f,
											0.00630f,
											0.00490f,
											0.00378f,
											0.00295f,
											0.00242f,
											0.00224f,
											0.00240f,
											0.00293f,
											0.00384f,
											0.00517f,
											0.00698f,
											0.00930f,
											0.01215f,
											0.01554f,
											0.01948f,
											0.02399f,
											0.02910f,
											0.03481f,
											0.04112f,
											0.04799f,
											0.05538f,
											0.06327f,
											0.07164f,
											0.08046f,
											0.08974f,
											0.09946f,
											0.10960f,
											0.12017f,
											0.13111f,
											0.14237f,
											0.15385f,
											0.16550f,
											0.17726f,
											0.18914f,
											0.20117f,
											0.21337f,
											0.22575f,
											0.23832f,
											0.25107f,
											0.26399f,
											0.27710f,
											0.29040f,
											0.30389f,
											0.31757f,
											0.33144f,
											0.34548f,
											0.35970f,
											0.37408f,
											0.38864f,
											0.40338f,
											0.41831f,
											0.43345f,
											0.44880f,
											0.46434f,
											0.48006f,
											0.49597f,
											0.51205f,
											0.52830f,
											0.54469f,
											0.56121f,
											0.57782f,
											0.59450f,
											0.61122f,
											0.62798f,
											0.64476f,
											0.66157f,
											0.67840f,
											0.69524f,
											0.71206f,
											0.72883f,
											0.74552f,
											0.76210f,
											0.77854f,
											0.79483f,
											0.81093f,
											0.82682f,
											0.84250f,
											0.85793f,
											0.87308f,
											0.88789f,
											0.90232f,
											0.91630f,
											0.92980f,
											0.94280f,
											0.95528f,
											0.96722f,
											0.97860f,
											0.98939f,
											0.99955f,
											1.00909f,
											1.01801f,
											1.02630f,
											1.03398f,
											1.04099f,
											1.04719f,
											1.05247f,
											1.05670f,
											1.05979f,
											1.06180f,
											1.06281f,
											1.06291f,
											1.06220f,
											1.06074f,
											1.05844f,
											1.05522f,
											1.05098f,
											1.04560f,
											1.03904f,
											1.03136f,
											1.02267f,
											1.01305f,
											1.00260f,
											0.99137f,
											0.97933f,
											0.96649f,
											0.95285f,
											0.93840f,
											0.92319f,
											0.90724f,
											0.89050f,
											0.87292f,
											0.85445f,
											0.83508f,
											0.81495f,
											0.79419f,
											0.77295f,
											0.75140f,
											0.72958f,
											0.70759f,
											0.68560f,
											0.66381f,
											0.64240f,
											0.62151f,
											0.60111f,
											0.58111f,
											0.56140f,
											0.54190f,
											0.52260f,
											0.50355f,
											0.48474f,
											0.46619f,
											0.44790f,
											0.42986f,
											0.41210f,
											0.39464f,
											0.37753f,
											0.36080f,
											0.34446f,
											0.32852f,
											0.31302f,
											0.29800f,
											0.28350f,
											0.26954f,
											0.25612f,
											0.24319f,
											0.23073f,
											0.21870f,
											0.20710f,
											0.19592f,
											0.18517f,
											0.17483f,
											0.16490f,
											0.15537f,
											0.14623f,
											0.13749f,
											0.12915f,
											0.12120f,
											0.11364f,
											0.10646f,
											0.09969f,
											0.09333f,
											0.08740f,
											0.08190f,
											0.07680f,
											0.07208f,
											0.06769f,
											0.06360f,
											0.05981f,
											0.05628f,
											0.05297f,
											0.04982f,
											0.04677f,
											0.04378f,
											0.04088f,
											0.03807f,
											0.03540f,
											0.03290f,
											0.03056f,
											0.02838f,
											0.02634f,
											0.02445f,
											0.02270f,
											0.02108f,
											0.01960f,
											0.01824f,
											0.01699f,
											0.01584f,
											0.01479f,
											0.01383f,
											0.01295f,
											0.01213f,
											0.01136f,
											0.01063f,
											0.00994f,
											0.00929f,
											0.00868f,
											0.00811f,
											0.00758f,
											0.00709f,
											0.00663f,
											0.00620f,
											0.00579f,
											0.00541f,
											0.00505f,
											0.00472f,
											0.00440f,
											0.00411f,
											0.00383f,
											0.00358f,
											0.00333f,
											0.00311f,
											0.00290f,
											0.00270f,
											0.00252f,
											0.00235f,
											0.00220f,
											0.00205f,
											0.00191f,
											0.00178f,
											0.00166f,
											0.00155f,
											0.00144f,
											0.00134f,
											0.00125f,
											0.00116f,
											0.00108f,
											0.00100f,
											0.00093f,
											0.00086f,
											0.00080f,
											0.00074f,
											0.00069f,
											0.00064f,
											0.00059f,
											0.00055f,
											0.00051f,
											0.00048f,
											0.00044f,
											0.00041f,
											0.00038f,
											0.00036f,
											0.00033f,
											0.00031f,
											0.00029f,
											0.00027f,
											0.00025f,
											0.00023f,
											0.00022f,
											0.00020f,
											0.00019f,
											0.00018f,
											0.00017f,
											0.00016f,
											0.00014f,
											0.00013f,
											0.00013f,
											0.00012f,
											0.00011f,
											0.00010f,
											0.00010f,
											0.00009f,
											0.00008f,
											0.00008f,
											0.00007f,
											0.00007f,
											0.00006f,
											0.00006f,
											0.00005f,
											0.00005f,
											0.00005f,
											0.00004f,
											0.00004f };

const float ColorMatchingFunctions::yBarFunction[] = { 0.00004f,
											   0.00004f,
											   0.00005f,
											   0.00005f,
											   0.00006f,
											   0.00006f,
											   0.00007f,
											   0.00008f,
											   0.00009f,
											   0.00011f,
											   0.00012f,
											   0.00013f,
											   0.00015f,
											   0.00017f,
											   0.00019f,
											   0.00022f,
											   0.00025f,
											   0.00028f,
											   0.00032f,
											   0.00036f,
											   0.00040f,
											   0.00043f,
											   0.00047f,
											   0.00052f,
											   0.00057f,
											   0.00064f,
											   0.00072f,
											   0.00083f,
											   0.00094f,
											   0.00107f,
											   0.00121f,
											   0.00136f,
											   0.00153f,
											   0.00172f,
											   0.00194f,
											   0.00218f,
											   0.00245f,
											   0.00276f,
											   0.00312f,
											   0.00353f,
											   0.00400f,
											   0.00455f,
											   0.00516f,
											   0.00583f,
											   0.00655f,
											   0.00730f,
											   0.00809f,
											   0.00891f,
											   0.00977f,
											   0.01066f,
											   0.01160f,
											   0.01257f,
											   0.01358f,
											   0.01463f,
											   0.01572f,
											   0.01684f,
											   0.01801f,
											   0.01921f,
											   0.02045f,
											   0.02172f,
											   0.02300f,
											   0.02429f,
											   0.02561f,
											   0.02696f,
											   0.02835f,
											   0.02980f,
											   0.03131f,
											   0.03288f,
											   0.03452f,
											   0.03623f,
											   0.03800f,
											   0.03985f,
											   0.04177f,
											   0.04377f,
											   0.04584f,
											   0.04800f,
											   0.05024f,
											   0.05257f,
											   0.05498f,
											   0.05746f,
											   0.06000f,
											   0.06260f,
											   0.06528f,
											   0.06804f,
											   0.07091f,
											   0.07390f,
											   0.07702f,
											   0.08027f,
											   0.08367f,
											   0.08723f,
											   0.09098f,
											   0.09492f,
											   0.09905f,
											   0.10337f,
											   0.10788f,
											   0.11260f,
											   0.11753f,
											   0.12267f,
											   0.12799f,
											   0.13345f,
											   0.13902f,
											   0.14468f,
											   0.15047f,
											   0.15646f,
											   0.16272f,
											   0.16930f,
											   0.17624f,
											   0.18356f,
											   0.19127f,
											   0.19942f,
											   0.20802f,
											   0.21712f,
											   0.22673f,
											   0.23686f,
											   0.24748f,
											   0.25860f,
											   0.27018f,
											   0.28229f,
											   0.29505f,
											   0.30858f,
											   0.32300f,
											   0.33840f,
											   0.35469f,
											   0.37170f,
											   0.38929f,
											   0.40730f,
											   0.42563f,
											   0.44431f,
											   0.46339f,
											   0.48294f,
											   0.50300f,
											   0.52357f,
											   0.54451f,
											   0.56569f,
											   0.58697f,
											   0.60820f,
											   0.62935f,
											   0.65031f,
											   0.67088f,
											   0.69084f,
											   0.71000f,
											   0.72819f,
											   0.74546f,
											   0.76197f,
											   0.77784f,
											   0.79320f,
											   0.80811f,
											   0.82250f,
											   0.83631f,
											   0.84949f,
											   0.86200f,
											   0.87381f,
											   0.88496f,
											   0.89549f,
											   0.90544f,
											   0.91485f,
											   0.92373f,
											   0.93209f,
											   0.93992f,
											   0.94723f,
											   0.95400f,
											   0.96026f,
											   0.96601f,
											   0.97126f,
											   0.97602f,
											   0.98030f,
											   0.98409f,
											   0.98742f,
											   0.99031f,
											   0.99281f,
											   0.99495f,
											   0.99671f,
											   0.99810f,
											   0.99911f,
											   0.99975f,
											   1.00000f,
											   0.99986f,
											   0.99930f,
											   0.99833f,
											   0.99690f,
											   0.99500f,
											   0.99260f,
											   0.98974f,
											   0.98644f,
											   0.98272f,
											   0.97860f,
											   0.97408f,
											   0.96917f,
											   0.96386f,
											   0.95813f,
											   0.95200f,
											   0.94545f,
											   0.93850f,
											   0.93116f,
											   0.92346f,
											   0.91540f,
											   0.90701f,
											   0.89828f,
											   0.88920f,
											   0.87978f,
											   0.87000f,
											   0.85986f,
											   0.84939f,
											   0.83862f,
											   0.82758f,
											   0.81630f,
											   0.80479f,
											   0.79308f,
											   0.78119f,
											   0.76915f,
											   0.75700f,
											   0.74475f,
											   0.73242f,
											   0.72000f,
											   0.70750f,
											   0.69490f,
											   0.68222f,
											   0.66947f,
											   0.65667f,
											   0.64384f,
											   0.63100f,
											   0.61816f,
											   0.60531f,
											   0.59248f,
											   0.57964f,
											   0.56680f,
											   0.55396f,
											   0.54114f,
											   0.52835f,
											   0.51563f,
											   0.50300f,
											   0.49047f,
											   0.47803f,
											   0.46568f,
											   0.45340f,
											   0.44120f,
											   0.42908f,
											   0.41704f,
											   0.40503f,
											   0.39303f,
											   0.38100f,
											   0.36892f,
											   0.35683f,
											   0.34478f,
											   0.33282f,
											   0.32100f,
											   0.30934f,
											   0.29785f,
											   0.28659f,
											   0.27562f,
											   0.26500f,
											   0.25476f,
											   0.24489f,
											   0.23533f,
											   0.22605f,
											   0.21700f,
											   0.20816f,
											   0.19955f,
											   0.19116f,
											   0.18297f,
											   0.17500f,
											   0.16722f,
											   0.15965f,
											   0.15228f,
											   0.14513f,
											   0.13820f,
											   0.13150f,
											   0.12502f,
											   0.11878f,
											   0.11277f,
											   0.10700f,
											   0.10148f,
											   0.09619f,
											   0.09112f,
											   0.08626f,
											   0.08160f,
											   0.07712f,
											   0.07283f,
											   0.06871f,
											   0.06477f,
											   0.06100f,
											   0.05740f,
											   0.05396f,
											   0.05067f,
											   0.04755f,
											   0.04458f,
											   0.04176f,
											   0.03908f,
											   0.03656f,
											   0.03420f,
											   0.03200f,
											   0.02996f,
											   0.02808f,
											   0.02633f,
											   0.02471f,
											   0.02320f,
											   0.02180f,
											   0.02050f,
											   0.01928f,
											   0.01812f,
											   0.01700f,
											   0.01590f,
											   0.01484f,
											   0.01381f,
											   0.01283f,
											   0.01192f,
											   0.01107f,
											   0.01027f,
											   0.00953f,
											   0.00885f,
											   0.00821f,
											   0.00762f,
											   0.00709f,
											   0.00659f,
											   0.00614f,
											   0.00572f,
											   0.00534f,
											   0.00500f,
											   0.00468f,
											   0.00438f,
											   0.00410f,
											   0.00384f,
											   0.00359f,
											   0.00335f,
											   0.00313f,
											   0.00293f,
											   0.00274f,
											   0.00256f,
											   0.00239f,
											   0.00224f,
											   0.00209f,
											   0.00195f,
											   0.00182f,
											   0.00170f,
											   0.00159f,
											   0.00148f,
											   0.00138f,
											   0.00129f,
											   0.00120f,
											   0.00112f,
											   0.00105f,
											   0.00098f,
											   0.00091f,
											   0.00085f,
											   0.00079f,
											   0.00074f,
											   0.00069f,
											   0.00064f,
											   0.00060f,
											   0.00056f,
											   0.00052f,
											   0.00048f,
											   0.00045f,
											   0.00042f,
											   0.00039f,
											   0.00036f,
											   0.00034f,
											   0.00031f,
											   0.00029f,
											   0.00027f,
											   0.00025f,
											   0.00023f,
											   0.00021f,
											   0.00020f,
											   0.00019f,
											   0.00017f,
											   0.00016f,
											   0.00015f,
											   0.00014f,
											   0.00013f,
											   0.00012f,
											   0.00011f,
											   0.00010f,
											   0.00010f,
											   0.00009f,
											   0.00008f,
											   0.00008f,
											   0.00007f,
											   0.00007f,
											   0.00006f,
											   0.00006f,
											   0.00006f,
											   0.00005f,
											   0.00005f,
											   0.00005f,
											   0.00004f,
											   0.00004f,
											   0.00004f,
											   0.00003f,
											   0.00003f,
											   0.00003f,
											   0.00003f,
											   0.00003f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00001f };

const float ColorMatchingFunctions::zBarFunction[] = { 0.00645f,
											   0.00708f,
											   0.00775f,
											   0.00850f,
											   0.00941f,
											   0.01055f,
											   0.01197f,
											   0.01366f,
											   0.01559f,
											   0.01773f,
											   0.02005f,
											   0.02251f,
											   0.02520f,
											   0.02828f,
											   0.03190f,
											   0.03621f,
											   0.04144f,
											   0.04750f,
											   0.05412f,
											   0.06100f,
											   0.06785f,
											   0.07449f,
											   0.08136f,
											   0.08915f,
											   0.09854f,
											   0.11020f,
											   0.12461f,
											   0.14170f,
											   0.16130f,
											   0.18326f,
											   0.20740f,
											   0.23369f,
											   0.26261f,
											   0.29477f,
											   0.33080f,
											   0.37130f,
											   0.41621f,
											   0.46546f,
											   0.51969f,
											   0.57953f,
											   0.64560f,
											   0.71848f,
											   0.79671f,
											   0.87785f,
											   0.95944f,
											   1.03905f,
											   1.11537f,
											   1.18850f,
											   1.25812f,
											   1.32393f,
											   1.38560f,
											   1.44264f,
											   1.49480f,
											   1.54219f,
											   1.58488f,
											   1.62296f,
											   1.65640f,
											   1.68530f,
											   1.70987f,
											   1.73038f,
											   1.74706f,
											   1.76004f,
											   1.76962f,
											   1.77626f,
											   1.78043f,
											   1.78260f,
											   1.78297f,
											   1.78170f,
											   1.77920f,
											   1.77587f,
											   1.77211f,
											   1.76826f,
											   1.76404f,
											   1.75894f,
											   1.75247f,
											   1.74410f,
											   1.73356f,
											   1.72086f,
											   1.70594f,
											   1.68874f,
											   1.66920f,
											   1.64753f,
											   1.62341f,
											   1.59602f,
											   1.56453f,
											   1.52810f,
											   1.48611f,
											   1.43952f,
											   1.38988f,
											   1.33874f,
											   1.28764f,
											   1.23742f,
											   1.18782f,
											   1.13876f,
											   1.09015f,
											   1.04190f,
											   0.99420f,
											   0.94735f,
											   0.90145f,
											   0.85662f,
											   0.81295f,
											   0.77052f,
											   0.72944f,
											   0.68991f,
											   0.65210f,
											   0.61620f,
											   0.58233f,
											   0.55042f,
											   0.52034f,
											   0.49197f,
											   0.46518f,
											   0.43992f,
											   0.41618f,
											   0.39388f,
											   0.37295f,
											   0.35330f,
											   0.33486f,
											   0.31755f,
											   0.30134f,
											   0.28617f,
											   0.27200f,
											   0.25882f,
											   0.24648f,
											   0.23477f,
											   0.22345f,
											   0.21230f,
											   0.20117f,
											   0.19012f,
											   0.17923f,
											   0.16856f,
											   0.15820f,
											   0.14814f,
											   0.13838f,
											   0.12899f,
											   0.12008f,
											   0.11170f,
											   0.10390f,
											   0.09667f,
											   0.08998f,
											   0.08385f,
											   0.07825f,
											   0.07321f,
											   0.06868f,
											   0.06457f,
											   0.06079f,
											   0.05725f,
											   0.05390f,
											   0.05075f,
											   0.04775f,
											   0.04490f,
											   0.04216f,
											   0.03951f,
											   0.03694f,
											   0.03446f,
											   0.03209f,
											   0.02984f,
											   0.02771f,
											   0.02569f,
											   0.02379f,
											   0.02199f,
											   0.02030f,
											   0.01872f,
											   0.01724f,
											   0.01586f,
											   0.01458f,
											   0.01340f,
											   0.01231f,
											   0.01130f,
											   0.01038f,
											   0.00953f,
											   0.00875f,
											   0.00804f,
											   0.00738f,
											   0.00679f,
											   0.00624f,
											   0.00575f,
											   0.00530f,
											   0.00490f,
											   0.00453f,
											   0.00420f,
											   0.00390f,
											   0.00362f,
											   0.00337f,
											   0.00314f,
											   0.00293f,
											   0.00275f,
											   0.00259f,
											   0.00244f,
											   0.00231f,
											   0.00220f,
											   0.00210f,
											   0.00202f,
											   0.00195f,
											   0.00189f,
											   0.00184f,
											   0.00180f,
											   0.00177f,
											   0.00174f,
											   0.00171f,
											   0.00168f,
											   0.00165f,
											   0.00161f,
											   0.00156f,
											   0.00151f,
											   0.00146f,
											   0.00140f,
											   0.00134f,
											   0.00127f,
											   0.00120f,
											   0.00115f,
											   0.00110f,
											   0.00107f,
											   0.00105f,
											   0.00104f,
											   0.00102f,
											   0.00100f,
											   0.00097f,
											   0.00093f,
											   0.00089f,
											   0.00084f,
											   0.00080f,
											   0.00076f,
											   0.00072f,
											   0.00069f,
											   0.00065f,
											   0.00060f,
											   0.00055f,
											   0.00049f,
											   0.00044f,
											   0.00038f,
											   0.00034f,
											   0.00031f,
											   0.00028f,
											   0.00027f,
											   0.00025f,
											   0.00024f,
											   0.00023f,
											   0.00022f,
											   0.00021f,
											   0.00020f,
											   0.00019f,
											   0.00017f,
											   0.00016f,
											   0.00014f,
											   0.00012f,
											   0.00010f,
											   0.00009f,
											   0.00007f,
											   0.00007f,
											   0.00006f,
											   0.00005f,
											   0.00004f,
											   0.00004f,
											   0.00004f,
											   0.00003f,
											   0.00003f,
											   0.00003f,
											   0.00003f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00002f,
											   0.00001f,
											   0.00001f,
											   0.00001f,
											   0.00001f,
											   0.00001f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f,
											   0.00000f };

const unsigned int ColorMatchingFunctions::STARTING_WAVELENGTH = 380;
const unsigned int ColorMatchingFunctions::ENDING_WAVELENGTH = 780;

CIEXYZColor ColorMatchingFunctions::Apply(const LightSpectrum& rLightSpectrum)
{
	float X = 0, Y = 0, Z = 0;

	if (rLightSpectrum.GetStartingWavelength() < STARTING_WAVELENGTH || rLightSpectrum.GetEndingWavelength() > ENDING_WAVELENGTH)
	{
		THROW_EXCEPTION(Exception, "Light spectrum out of wavelength range");
	}

	for (unsigned int i = rLightSpectrum.GetStartingWavelength(), c = 0; i < rLightSpectrum.GetEndingWavelength(); i += rLightSpectrum.GetPrecision())
	{
		float xBar = xBarFunction[i - STARTING_WAVELENGTH];
		float yBar = yBarFunction[i - STARTING_WAVELENGTH];
		float zBar = zBarFunction[i - STARTING_WAVELENGTH];
		float l = rLightSpectrum[c];
		X += l * xBar;
		Y += l * yBar;
		Z += l * zBar;
	}

	// normalizing
	X /= Y;
	Z /= Y;
	Y /= Y;

	return CIEXYZColor(X, Y, Z);
}